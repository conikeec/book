language: c

sudo: required

install:
  - nvm install stable
  - npm install -g gitbook-cli

script: 
  - cd "$TRAVIS_BUILD_DIR"
  - gitbook install
  - gitbook build
  - # This generates a `web` directory containing the website.
  - cp ./CNAME ./_book/CNAME
  - cd _book
  - git init
  - git checkout -b gh-pages
  - git add .
  - git -c user.name='travis' -c user.email='travis@travis.travis' commit -m init
  - # Make sure to make the output quiet, or else the API token will leak!
  - # This works because the API key can replace your password.
  - git push -f -q https://qinwf:$GITHUB_API_KEY@github.com/rustr/book.git gh-pages &2>/dev/null

notifications:
  email:
    on_success: change
    on_failure: always
