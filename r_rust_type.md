## R Type <-> Rust Type

Let's look at the code generated by rustrize().

#### Origin:

```rust
pub fn say_hi(a:String)-> String{
	a
}
```


#### Generated:

```rust
#[no_mangle]
pub extern "C" fn rustr_say_hi(a : SEXP)->SEXP{

 let a_ : String = unwrapr!( String::rnew(a) );
 let res  = say_hi(a_);

 let res_sexp : SEXP = unwrapr!(res.intor());

 return res_sexp;
}
```

`rustr_say_hi`  take a SEXP R pointer and then use `String::rnew` to convert SEXP to Rust String.

#### RNew

`rnew` is from trait `RNew`:

```rust
pub trait RNew where Self: Sized
{
    fn rnew(x: SEXP) -> RResult<Self>;
}
```

`String` impl `RNew`, so we can call `String::rnew(SEXP)`.

```rust
impl RNew for String {
    fn rnew(x: SEXP) -> RResult<String> {
        .....
    }
}
```  

And that is all. If you want to use you **own** awesome Rust type as input. impl `RNew` for it.

#### IntoR

```rust
#[no_mangle]
pub extern "C" fn rustr_say_hi(a : SEXP)->SEXP{

 let a_ : String = unwrapr!( String::rnew(a) );
 let res  = say_hi(a_);

 let res_sexp : SEXP = unwrapr!(res.intor());

 return res_sexp;
}
```

From `say_hi(a_)` we get a String. We run `res.intor()`. `String` impl `IntoR`, so we can call `res.intor()`.

```rust
pub trait IntoR {
    fn intor(&self) -> RResult<SEXP>;
}
```

`RNew` - R type to a new Rust type

`IntoR` - Rust type to R type

Hope this is simple enough.

If you want to use you **own** awesome Rust type as **output**. impl `IntoR` for it.

## Orphan Rule

There is an orphan rule to take care. Only your **own** Rust type can impl traits from `rustr` crates.

If you want to impl `RNew` for `Vec<String>`, you may not get lucky. But you can create a struct to wrap Vec<String>. Rust's zero-cost abstraction feature often helps you eliminate the overhead.

## Want Your `RNew` `IntoR` impl Added to `rustr` Crate? 

Create a pull request! 

We will consider support some rust crates with feature tag. For example, [`chrono`](https://github.com/lifthrasiir/rust-chrono) crate for time.
